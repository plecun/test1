<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>飘窗浮动</title>
<meta name="keywords" content="关键词"/>
<meta name="description" content="简介"/>
<!--上线后删除开始-->
<script type="text/javascript" src="http://js.aili.com/jquery-1.4.2.min.js"></script>
<link href="http://css.aili.com/reset_v4.css" rel="stylesheet"/>
<style type="text/css">
.w_w{width:1200px;margin-left:auto;margin-right:auto;overflow:hidden;}
.mFrame_a{height:500px;background:#f00;}
.mFrame_b{height:300px;background:#ff0;}
.mFrame_c{height:800px;background:#f0f;}
.mFrame_d{height:200px;background:#fe0;}
.mFrame_e{height:400px;background:#f55;}
.mFrame_f{height:600px;background:#f30;}
.mFrame_g{height:400px;background:#f09;}
.mNav{width:200px;position:absolute;top:500px;right:50%;margin-right:-820px;background:#333;}
.mNav ul{width:100%;display:block;overflow:hidden;}
.mNav li{width:100%;line-height:30px;height:30px;color:#fff;background:#666;text-align:center;display:block;overflow:hidden;}
.mNav li.hov{background:#333;}
</style>
<!--上线后删除结束-->
<!--[if lt IE 9]>
<script src="http://js.aili.com/html5.js" type="text/javascript"></script>
<![endif]-->
<!--[if IE 6]>
<script src="http://js.aili.com/DD_belatedPNG.js"></script>
<script type="text/javascript">   
DD_belatedPNG.fix('.mTm');   
</script>
<![endif]-->
</head>
<body>
<div class="mFrame_a w_w"></div>
<div class="mFrame_b w_w"></div>
<div class="mFrame_c w_w"></div>
<div class="mFrame_d w_w"></div>
<div class="mFrame_e w_w"></div>
<div class="mFrame_f w_w"></div>
<div class="mFrame_g w_w"></div>
<div class="mNav">
	<ul>
		<li class="hov">1</li>
		<li>2</li>
		<li>3</li>
		<li>4</li>
		<li>5</li>
	</ul>
</div>
<script>
$(document).ready(function(e){
	//IE6 7  因不清浮动造成获取值差异过大   CSS无法修改可填写偏移值
	var SideNav123 = new SideNav();
	SideNav123.init({
		"Start":".mFrame_b",//开始位置class
		"Box":".mNav",//需要浮动class或元素
		"Cur":"",//浮动时添加的class或元素
		"End":".mFrame_g",//结束位置class或元素
		"Offset":"",//针对IE6 7 计算偏移值 页面元素都已清浮动  IE6 7  不会出现偏移值
		"Btn":"",//按钮
		"BtnHov":"",//按钮选中
		"Node":".mFrame_b,.mFrame_c,.mFrame_d,.mFrame_e,.mFrame_f",//节点 英文逗号分隔
	});
});
function SideNav(){//滑动
	this.mStart = null;//开始
	this.mEnd = null;//结束
	this.mOrigin = null;//当前
	this.mBtn = null;//滑动元素内子级对应按钮
	this.mHammer = null;//触控插件
	this.mRepeat = null;//时间重复
	this.mNodeOffsetTop = new Array();//节点数组
	this.mNode = null;//节点数组
	this.mbLR = false;//预防事件多次执行
	this.mSettings = {
		"Start":"",//开始位置class
		"Box":"",//需要浮动class或元素
		"Cur":"",//浮动时添加的class或元素
		"End":"",//结束位置class或元素
		"Offset":"",//针对IE6 7 计算偏移值 页面元素都已清浮动  IE6 7  不会出现偏移值
		"Btn":"",//按钮
		"BtnHov":"",//按钮选中
		"Node":"",//节点
	}
}
SideNav.prototype.init = function(mOpts){
	var This = this;
	deepCopy(mOpts,this.mSettings);//传值
	//alert(this.mSettings.Node.length)
	if(!$(this.mSettings.Box)){return false;}//没有需要滑动的元素就停止
	this.mBox = $(this.mSettings.Box);
	this.mStart = $(this.mSettings.Start).offset().top;
	this.mEnd = $(this.mSettings.End).offset().top;
	if(this.mSettings.Btn){//有按钮
		this.mBtn = $(this.mSettings.Btn);
		this.mBtnHov = this.mSettings.BtnHov.substr(1);
		this.mBtn.on(this.mTapstart,function(e){//点击按钮
			This.mbLR = true;
			if(This.mIntervalTime && This.mbLR){
				clearInterval(This.mRepeat);
			}
			This.mNow = This.mBtn.index(this);
			This.fnEnd(e);
		});
	}









	this.mNodeOffsetTopAll();//节点
	this.mSlide();//滑动




	
}
SideNav.prototype.mNodeOffsetTopAll = function(e){
	if(this.mSettings.Node){
		this.mNode = this.mSettings.Node.split(",");
		for(var i = 0;i < this.mNode.length;i++){
			this.mNodeOffsetTop[i] = $(this.mNode[i]).offset().top;
		}
	}
}
SideNav.prototype.mSlide = function(e){
	// if(this.mSettings.Node){
	// 	var mNodeOffsetTop = new Array();
	// 	this.mNode = this.mSettings.Node.split(",");
	// 	for(var i = 0;i < this.mNode.length;i++){
	// 		mNodeOffsetTop[i] = $(this.mNode[i]).offset().top;
	// 	}
	// }
	var This = this;
	var mBoxHei = this.mBox.outerHeight(true);
	var isIE = !!window.ActiveXObject;
	var isIE6 = isIE && !window.XMLHttpRequest;
	var isIE8 = isIE && !!document.documentMode;
	var isIE7 = isIE && !isIE6 && !isIE8;
	$(window).scroll(function(){
		var mScrolls = $(window).scrollTop();
		if(mScrolls < This.mStart && This.mbLR){
			This.mBox.removeClass("mRAdk_hov");
			if(isIE6 || isIE7){//兼容IE6 IE7
				This.mBox.removeAttr("style");
			}
			This.mbLR = false;
		}else if(mScrolls >= this.mEnd-mBoxHei && This.mbLR){
			This.mBox.css({"top":this.mEnd-mBoxHei+"px"});
			This.mbLR = false;
		}
		$.each(this.mNodeOffsetTop,function(i){
			alert(this.mNodeOffsetTop);
		});
		if(mNodeOffsetTop[i] <= mScrolls && mNodeOffsetTop[i+1] <= mScrolls){


		}


	});

}



function deepCopy(oParent,oCopy){//传值
	var oCopy = oCopy || {};
	for(var attr in oParent){
		if(typeof oParent[attr] == 'object'){
			oCopy[attr] = Object.prototype.toString.call(oParent[attr]) == '[object Array]' ? [] : {};
			deepCopy(oParent[attr],oCopy[attr]);
		}else{
			oCopy[attr] = oParent[attr];
		}
	}
}
</script>


</body>
</html>